<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="renderer" content="webkit">
		<link rel="shortcut icon" href="img/favicon.ico">
		<title>佣金设置 - 学校管理</title>
		<link href="css/bootstrap.min.css" rel="stylesheet">
		<link href="css/bootstrap-reset.css" rel="stylesheet">
		<link href="assets/font-awesome/css/font-awesome.css" rel="stylesheet">
		<link href="assets/advanced-datatable/media/css/demo_table.css" rel="stylesheet">
		<link rel="stylesheet" type="text/css" href="assets/bootstrap-datepicker/css/datepicker.css"><!-- BOOTSTRAP DATEPICKER PLUGIN CSS -->
		<link rel="stylesheet" type="text/css" href="assets/bootstrap-timepicker/compiled/timepicker.css"><!-- BOOTSTRAP TIMEPICKER PLUGIN CSS -->		
		<link rel="stylesheet" type="text/css" href="css/jquery.autocompleter.css">
		<link href="css/style.css" rel="stylesheet">
		<link href="css/style-responsive.css" rel="stylesheet">
		<link href="css/index.css" rel="stylesheet">
		<!--[if lt IE 9]>
			<script src="js/html5shiv.js"></script>
			<script src="js/respond.min.js"></script>
		<![endif]-->
	</head>

	<body id="school-setting" v-cloak>
		<section id="container">
			<header class="header white-bg">
				<div class="sidebar-toggle-box">
					<div data-placement="right" class="fa fa-bars tooltips">
					</div>
				</div>
				<a href="main.html" class="logo">
					佣金系统
					<span v-if="ap_list==='KJ'">
           	 会计
          </span>
          <span v-if="ap_list==='GW'">
           	 顾问
          </span>
          <span v-if="ap_list==='WA'">
           	 文案
          </span>
          <span v-if="ap_list==='MA'">
           	 Mara
          </span>
          <span v-if="ap_list==='SUPERAD'">
           	 超级管理员
          </span>
				</a>
				<div class="top-nav ">
					<ul class="nav pull-right top-menu">
						<li class="dropdown">
							<a data-toggle="dropdown" class="dropdown-toggle" href="#">
								<span class="username">
                  {{admin}}
                </span>
								<b class="caret">
                </b>
							</a>
							<ul class="dropdown-menu extended logout">
								<li class="log-arrow-up">
								</li>
								<li>
									<a href="password.html">
										<i class="fa fa-key">
                    </i> 修改密码
									</a>
								</li>
								<li><a href="javascript:tb.out();">
										<i class="fa fa-user">
                    </i> Log Out
									</a>
								</li>
							</ul>
						</li>
					</ul>
				</div>
			</header>
			<aside>
				<div id="sidebar" class="nav-collapse">
					<ul class="sidebar-menu" id="nav-accordion">
						<li >
              <a href="main.html">
                <i class="fa fa-dashboard">
                </i>
                <span>
                  Dashboard
                </span>
              </a>
            </li>
            <dli v-if="ap_list==='SUPERAD'">            
            <li>
              <a href="adviser.html">
                <i class="fa fa-book">
                </i>
                <span>
                  顾问管理
                </span>
              </a>
            </li>
            <li class="sub-menu">
							<a href="javascript:;">
								<i class="fa fa-book">
                </i>
								<span>
                 	 文案管理
                </span>
							</a>
							<ul class="sub">
								<li>
									<a href="official.html">
										文案管理
									</a>
								</li>
								<li>
									<a href="official-tag.html">
										订单标签管理
									</a>
								</li>								
							</ul>
						</li>
            <li>
              <a href="mara.html">
                <i class="fa fa-book">
                </i>
                <span>
                  MARA管理
                </span>
              </a>
            </li>
            <li>
              <a href="accounting.html">
                <i class="fa fa-book">
                </i>
                <span>
                  会计管理
                </span>
              </a>
            </li>
            </dli>
          	<dli v-if="ap_list==='SUPERAD' || (ap_list==='GW' && gw_regionid !== 'null') || ap_list==='KJ'">
            <li class="sub-menu">
							<a href="javascript:;" class="active">
								<i class="fa fa-book">
                </i>
								<span>
                 	 学校管理
                </span>
							</a>
							<ul class="sub">
								<li v-if="ap_list==='SUPERAD'">
									<a href="school.html">
										学校管理
									</a>
								</li>
								<li class="active">
									<a href="school-setting.html">
										佣金设置
									</a>
								</li>								
							</ul>
						</li>
						</dli>
						<dli v-if="ap_list==='SUPERAD'">
            <li>
              <a href="receive-type.html">
                <i class="fa fa-book">
                </i>
                <span>
                  收款方式管理
                </span>
              </a>
            </li>
            <li>
              <a href="subagency.html">
                <i class="fa fa-book">
                </i>
                <span>
                  Subagency管理
                </span>
              </a>
            </li>
            <li>
              <a href="service.html">
                <i class="fa fa-book">
                </i>
                <span>
                  服务项目管理
                </span>
              </a>
            </li>
          	</dli>
          	<li v-if="ap_list!=='KJ' && ap_list!=='WA' && ap_list!=='MA'" class="sub-menu">
							<a href="javascript:;">
								<i class="fa fa-book">
                </i>
								<span>
                 	 客户管理
                </span>
							</a>
							<ul class="sub">
								<li>
									<a href="users.html">
										客户管理
									</a>
								</li>
								<li v-if="ap_list==='SUPERAD'">
									<a href="user-tags.html">
										标签管理
									</a>
								</li>								
							</ul>
						</li>
						<li v-if="ap_list!=='KJ'" class="sub-menu">
							<a href="serviceorder-list.html">
                <i class="fa fa-book">
                </i>
                <span>
                  服务订单管理
                </span>
              </a>
						</li>
            <li v-if="ap_list==='SUPERAD'" class="sub-menu">
							<a href="javascript:;">
								<i class="fa fa-book">
                </i>
								<span>
                 	 渠道管理
                </span>
							</a>
							<ul class="sub">
								<li>
									<a href="source.html">
										渠道列表
									</a>
								</li>
								<li>
									<a href="source-type.html">
										来源分类
									</a>
								</li>								
							</ul>
						</li>
						<li v-if="ap_list!=='WA' && ap_list!=='MA'" class="sub-menu">
							<a href="javascript:;">
								<i class="fa fa-book">
                </i>
								<span>
                 	 佣金表
                </span>
							</a>
							<ul class="sub">
								<li v-if="ap_list==='GW' || ap_list==='SUPERAD'" class="active">
									<a href="mycommission.html">
										我的佣金报表
									</a>									
								</li>
								<li v-if="ap_list==='GW' || ap_list==='SUPERAD'" style="display:;" id="apply_state_PENDING">
									<a href="mycommission.html?applyState=PENDING">
										未申请月奖
									</a>									
								</li>
								<li v-if="ap_list==='GW' || ap_list==='SUPERAD'" style="display:;" id="apply_state_COMPLETE">
									<a href="mycommission.html?applyState=COMPLETE">
										已申请月奖
									</a>									
								</li>
								<li v-if="ap_list==='KJ'" id="commission_state_DJY">
									<a href="mycommission-accounting.html?commission_state=DJY">
										待结佣订单
									</a>									
								</li>
								<li v-if="ap_list==='KJ'" id="commission_state_YJY">
									<a href="mycommission-accounting.html?commission_state=YJY">
										已结佣订单
									</a>									
								</li>								
								<li v-if="ap_list==='SUPERAD' || ap_list==='KJ'">
									<a href="mycommission-check-accounting.html">
										自动对账
									</a>									
								</li>
								<li v-if="ap_list==='SUPERAD'">
									<a href="create-visa-commission.html">
										重建签证佣金表订单
									</a>
								</li>
								<li v-if="ap_list==='SUPERAD' || ap_list==='KJ'">
									<a href="table-export.html">
										导出数据
									</a>
								</li>
							</ul>
						</li>
						<li v-if="ap_list==='KJ' || ap_list==='SUPERAD'" class="sub-menu">
							<a href="javascript:;">
								<i class="fa fa-book">
                </i>
								<span>
                 	 Tax Invoice管理
                </span>
							</a>
							<ul class="sub">
								<li id="invoice_">
									<a href="taxinvoice-list.html?state=&type=SF">
										Tax Invoice列表
									</a>									
								</li>
								<li id="invoice_canceled">
									<a href="taxinvoice-list.html?state=canceled&type=SF">
										已Cancel列表
									</a>									
								</li>															
							</ul>
						</li>
						<li class="sub-menu">
							<a href="javascript:;">
								<i class="fa fa-book">
                </i>
								<span>
                 	 知识库
                </span>
							</a>
							<ul class="sub">
								<li v-if="ap_list==='SUPERAD'">
									<a href="knowledge-menu.html">
										菜单管理
									</a>
								</li>
								<li>
									<a href="knowledge.html">
										知识库菜单
									</a>
								</li>
							</ul>
						</li>
					</ul>
				</div>
			</aside>
			<section id="main-content" class="content">
				<section class="wrapper site-min-height">
					<div class="row">
						<div class="col-lg-12">
							<section class="panel">
								<header class="panel-heading">
									佣金设置
								</header>
								<div class="panel-body">
									<div class="adv-table editable-table">
										<div class="alert alert-success fade in" style="display:none;position:absolute;z-index:9999;">
									      <button data-dismiss="alert" class="close close-sm" type="button">
									      <i class="fa fa-times"></i>
									      </button>
									      <strong>Success!</strong> You  just achieved success.
									  </div>
									  <div id="alert_error" class="alert alert-block alert-danger fade in" style="display:none;position:absolute;z-index:9999;">
                      <button data-dismiss="alert" class="close close-sm" type="button">                      
                      </button>
                      <strong id="error_info"></strong>
                    </div>
										<div class="clearfix">                       
                    </div>
										<div class="responsive-table margin-top">
											<input type="hidden" name="id" id="id" value="0" />
											<table class="display table table-bordered table-striped" id="example">
												<thead>
													<tr>
														<!--<th><input @click="checked" type="checkbox"></th>-->
														<th>ID</th>
														<th>学校</th>
														<th>选择佣金卡片类型</th>
														<th>当前参数</th>																							
														<th>周期内业务总额</th>
														<th>周期内业务总量</th>
														<th>合同附件</th>
														<th>备注</th>
													</tr>
												</thead>
												<tbody>
													<tr v-for="item in subject" class="gradeX" id="list_{{item.id}}">
														<td v-html="item.oid"></td>
														<td v-html="item.schoolName1" style="width:400px;"></td>
														<td v-html="item.str_type"></td>
														<td v-html="item.str_parameters" style="color:#008000;"></td>														
														<td v-html="item.amount"></td>
														<td v-html="item.count"></td>
														<td>																
																<div v-html="item.attachments" style="margin-top:10px;"></div>
																<div style="margin-top:10px;"><button onclick="show_upload_attachment('{{item.schoolName}}','{{item.str_flist}}');" type="button" class="btn btn-primary">上传合同</button></div>
														</td>
														<td>
																<div id="remarks{{item.id}}">{{item.str_remarks}}</div>
																<div style="margin-top:10px;"><button onclick="show_update_remarks({{item.id}},'{{item.schoolName}}');" type="button" class="btn btn-primary">更新备注</button></div>
														</td>
													</tr>
												</tbody>
											</table>
										</div>
										<div class="row-fluid">
											&nbsp;
										</div>
									</div>
								</div>
							</section>
						</div>
					</div>
				</section>
			</section>
			<footer class="site-footer">
				<div class="text-center">
					2018 &copy; 佣金系统 by <span style="color:#2a8ba7;">GIG</span>.
					<a href="#" class="go-top">
						<i class="fa fa-angle-up">
            </i>
					</a>
				</div>
			</footer>
		</section>
		<div class="modal fade" id="type1_id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel">固定比例（无额外补贴）</h4>
					</div>
					<div class="modal-body">
							<form class="form-horizontal">
							<div class="form-group">
								<label class="col-sm-4 control-label">合同周期：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t1a1" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd"> to <input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t1a2" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">设置成本占原价比例 x%</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t1b1" class="form-control" placeholder="请填写数字"> %
								</div>
							</div>
							</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button onclick="type1_SetSave()" type="button" class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="type2_id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel">固定比例+每人补贴</h4>
					</div>
					<div class="modal-body">
							<form class="form-horizontal">
							<div class="form-group">
								<label class="col-sm-4 control-label">合同周期：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t2a1" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd"> to <input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t2a2" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">设置成本占原价比例 x%</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t2b1" class="form-control" placeholder="请填写数字"> %
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">设置每人补贴：<span style="color:red;">(必填)</span></label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t2c1" class="form-control" placeholder=""> 从
									<input type="text" autocomplete="off" style="width:70px;display:Inline;" id="t2c2" class="form-control" placeholder=""> 到
									<input type="text" autocomplete="off" style="width:70px;display:Inline;" id="t2c3" class="form-control" placeholder=""> 人
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">设置每人补贴：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t2d1" class="form-control" placeholder=""> 从
									<input type="text" autocomplete="off" style="width:70px;display:Inline;" id="t2d2" class="form-control" placeholder=""> 到
									<input type="text" autocomplete="off" style="width:70px;display:Inline;" id="t2d3" class="form-control" placeholder=""> 人
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">设置每人补贴：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t2e1" class="form-control" placeholder=""> 从
									<input type="text" autocomplete="off" style="width:70px;display:Inline;" id="t2e2" class="form-control" placeholder=""> 到
									<input type="text" autocomplete="off" style="width:70px;display:Inline;" id="t2e3" class="form-control" placeholder=""> 人
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">设置每人补贴：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t2f1" class="form-control" placeholder=""> 从
									<input type="text" autocomplete="off" style="width:70px;display:Inline;" id="t2f2" class="form-control" placeholder=""> 到
									<input type="text" autocomplete="off" style="width:70px;display:Inline;" id="t2f3" class="form-control" placeholder=""> 人
								</div>
							</div>
							<div class="form-group">
									<label class="col-sm-12 control-label" style="color:red;">温馨提示：【每人补贴必须为不含GST金额，如与合同金额不一致请计算后填入】</label>
							</div>
							</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button onclick="type2_SetSave()" type="button" class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="type3_id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel">固定比例+固定一次性补贴</h4>
					</div>
					<div class="modal-body">
							<form class="form-horizontal">
							<div class="form-group">
								<label class="col-sm-4 control-label">合同周期：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t3a1" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd"> to <input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t3a2" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">设置成本占原价比例 x%</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t3b1" class="form-control" placeholder="请填写数字"> %
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">总人数达到：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t3c1" class="form-control" placeholder=""> 人，一次性补贴 $ <input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t3c2" class="form-control" placeholder="">
								</div>
							</div>
							</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button onclick="type3_SetSave()" type="button" class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="type4_id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel">变动比例</h4>
					</div>
					<div class="modal-body">
							<form class="form-horizontal">
							<div class="form-group">
								<label class="col-sm-4 control-label">合同周期：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t4a1" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd"> to <input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t4a2" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd">
								</div>
							</div>							
							<div class="form-group">
								<label class="col-sm-4 control-label">总人数达到：<span style="color:red;">(必填)</span></label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t4b1" class="form-control" placeholder=""> 人，成本比例为 <input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t4b2" class="form-control" placeholder=""> %
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">总人数达到：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t4c1" class="form-control" placeholder=""> 人，成本比例为 <input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t4c2" class="form-control" placeholder=""> %
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">总人数达到：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t4d1" class="form-control" placeholder=""> 人，成本比例为 <input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t4d2" class="form-control" placeholder=""> %
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">总人数达到：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t4e1" class="form-control" placeholder=""> 人，成本比例为 <input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t4e2" class="form-control" placeholder=""> %
								</div>
							</div>
							</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button onclick="type4_SetSave()" type="button" class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="type7_id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel">固定底价（无额外补贴）</h4>
					</div>
					<div class="modal-body">
							<form class="form-horizontal">
							<div class="form-group">
								<label class="col-sm-4 control-label">合同周期：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t7a1" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd"> to <input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t7a2" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">底价</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t7a3" class="form-control" placeholder="">
								</div>
							</div>							
							</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button onclick="type7_SetSave()" type="button" class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="type5_id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel">固定底价+每人补贴</h4>
					</div>
					<div class="modal-body">
							<form class="form-horizontal">
							<div class="form-group">
								<label class="col-sm-4 control-label">合同周期：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t5a1" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd"> to <input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t5a2" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">点击设置各课程成本：</label>
								<div class="col-sm-8" style="padding: 6px 12px;">
									<a href="javascript:loadschoolsubject_5();">课程列表</a>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">总人数达到：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t5b1" class="form-control" placeholder=""> 人，每人补贴 $ <input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t5b2" class="form-control" placeholder="">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">总人数达到：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t5c1" class="form-control" placeholder=""> 人，每人补贴 $ <input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t5c2" class="form-control" placeholder="">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">总人数达到：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t5d1" class="form-control" placeholder=""> 人，每人补贴 $ <input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t5d2" class="form-control" placeholder="">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">总人数达到：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t5e1" class="form-control" placeholder=""> 人，每人补贴 $ <input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t5e2" class="form-control" placeholder="">
								</div>
							</div>
							</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button onclick="type5_SetSave()" type="button" class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="type6_id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel">固定底价+固定一次性补贴</h4>
					</div>
					<div class="modal-body">
							<form class="form-horizontal">
							<div class="form-group">
								<label class="col-sm-4 control-label">合同周期：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t6a1" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd"> to <input type="text" autocomplete="off" style="width:150px;display:Inline;" id="t6a2" class="form-control default-date-picker1" placeholder="请选择日期" data-date-format="yyyy-mm-dd">
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">点击设置各课程成本：</label>
								<div class="col-sm-8" style="padding: 6px 12px;">
									<a href="javascript:loadschoolsubject_6();">课程列表</a>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-4 control-label">总人数达到：</label>
								<div class="col-sm-8">
									<input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t6b1" class="form-control" placeholder=""> 人，一次性补贴 $ <input type="text" autocomplete="off" style="width:100px;display:Inline;" id="t6b2" class="form-control" placeholder="">
								</div>
							</div>
							</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button onclick="type6_SetSave()" type="button" class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="type7a_id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="schoolname_7a">学校名字</h4>
					</div>
					<div class="modal-body">
							<form class="form-horizontal">
							<table class="display table table-bordered table-striped" id="example1">
							<thead>
								<tr>
									<th>课程名称</th>
									<th>底价</th>									
								</tr>
							</thead>
							<tbody>
							<tr v-for="item in subject1" class="gradeX">
								<td v-html="item.subject"></td>
								<td v-html="item.price"></td>
							</tr>
							</tbody>
							</table>
							</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button onclick="type7a_SetSave()" type="button" class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="type5a_id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="schoolname_5a">学校名字</h4>
					</div>
					<div class="modal-body">
							<form class="form-horizontal">
							<table class="display table table-bordered table-striped" id="example5">
							<thead>
								<tr>
									<th>课程名称</th>
									<th>底价</th>									
								</tr>
							</thead>
							<tbody>
							<tr v-for="item in subject1" class="gradeX">
								<td v-html="item.subject"></td>
								<td v-html="item.price"></td>
							</tr>
							</tbody>
							</table>
							</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button onclick="type5a_SetSave()" type="button" class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="type6a_id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="schoolname_6a">学校名字</h4>
					</div>
					<div class="modal-body">
							<form class="form-horizontal">
							<table class="display table table-bordered table-striped" id="example6">
							<thead>
								<tr>
									<th>课程名称</th>
									<th>底价</th>									
								</tr>
							</thead>
							<tbody>
							<tr v-for="item in subject1" class="gradeX">
								<td v-html="item.subject"></td>
								<td v-html="item.price"></td>
							</tr>
							</tbody>
							</table>
							</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
						<button onclick="type6a_SetSave()" type="button" class="btn btn-primary">确认</button>
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="school_attachments" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="static">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel">上传合同附件</h4>
					</div>
					<div id="alert_success" class="alert alert-success fade in" style="display:none;position:absolute;z-index:9999;">
			      <button data-dismiss="alert" class="close close-sm" type="button">
			      <i class="fa fa-times"></i>
			      </button>
			      <strong>Success!</strong> You  just achieved success.
			  	</div>
			  	<div id="alert_error" class="alert alert-block alert-danger fade in" style="display:none;position:absolute;z-index:9999;">
		        <button data-dismiss="alert" class="close close-sm" type="button">
		        <i class="fa fa-times"></i>
		        </button>
		        <strong id="error_info"></strong>
		      </div>
					<div class="modal-body">
							<form class="form-horizontal" autocomplete="off">							
							<div class="form-group">
								<label class="col-sm-3 control-label">学校名称</label>
								<div class="col-sm-8">
									<label id="schoolName"></label>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-3 control-label">上传合同文件<br/>(最多3份)</label>
								<div class="col-sm-8">
									<input type="hidden" id="school_name" value="" />
									<input type="file" id="f1" style="display:none">
									<input type="file" id="f1e1" style="display:none">
									<input type="file" id="f1e2" style="display:none">
									<input type="file" id="f1e3" style="display:none">
									<input type="hidden" id="flist" value="" />
									<div id="show_pic" style="display:none;padding-bottom:10px;"></div>
									<button onclick="upload_attachment('f1')" id="new_upload_attachment" type="button" class="btn btn-danger">上传合同附件</button>
								</div>
							</div>
							</form>
					</div>
					<div class="modal-footer">
						<button onclick="uploadAttachment()" type="button" class="btn btn-primary">更新</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>					
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="school_remarks" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop="static">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
						<h4 class="modal-title" id="myModalLabel">更新学校备注</h4>
					</div>
					<div id="alert_success" class="alert alert-success fade in" style="display:none;position:absolute;z-index:9999;">
			      <button data-dismiss="alert" class="close close-sm" type="button">
			      <i class="fa fa-times"></i>
			      </button>
			      <strong>Success!</strong> You  just achieved success.
			  	</div>
			  	<div id="alert_error" class="alert alert-block alert-danger fade in" style="display:none;position:absolute;z-index:9999;">
		        <button data-dismiss="alert" class="close close-sm" type="button">
		        <i class="fa fa-times"></i>
		        </button>
		        <strong id="error_info"></strong>
		      </div>
					<div class="modal-body">
							<form class="form-horizontal" autocomplete="off">							
							<div class="form-group">
								<label class="col-sm-3 control-label">学校名称</label>
								<div class="col-sm-8">
									<label id="schoolName"></label>
								</div>
							</div>
							<div class="form-group">
								<label class="col-sm-3 control-label">备注内容</label>
								<div class="col-sm-8">
										<input type="hidden" id="school_name" value="" />
										<textarea name="remarks" id="remarks" class="form-control" style="width:100%;height:250px;color:#797979;" placeholder="1. 热门课程及学校名称
2.学费 Instalment和学杂费
3.开课时间（学校late enrol时限）
4.地址
5. 卖点
6.近期Promotion
7.移民方案
8.校方联系人及联系方式
9.申请方式及申请邮箱
10. Commission Rate及Bonus
11.学校网址链接
12. 备注"></textarea>
								</div>
							</div>
							</form>
					</div>
					<div class="modal-footer">
						<button onclick="updateRemarks()" type="button" class="btn btn-primary">更新</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>					
					</div>
				</div>
			</div>
		</div>
		<div class="modal fade" id="loading_id" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" data-backdrop='static' style="z-index:99999;">
			<div class="modal-dialog" role="document" style="width:350px;">
				<div class="modal-content">
					<div class="modal-header">
					</div>
					<div class="modal-body">
							<div style="text-align:center;color:#0066CC;"><img src="img/input-spinner.gif" /> 正在执行，请稍后...</div>
					</div>
					
				</div>
			</div>
		</div>
		<script src="js/jquery-1.8.3.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/jquery.dcjqaccordion.2.7.js"></script>
		<script src="js/jquery.scrollTo.min.js"></script>
		<script src="js/jquery.nicescroll.js"></script>
		<script src="assets/bootstrap-datepicker/js/bootstrap-datepicker.js"></script><!-- BOOTSTRAP DATEPICKER JS  -->
    <script src="assets/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js"></script><!-- BOOTSTRAP DATETIMEPICKER JS  -->
    <script src="js/jquery.autocompleter.js"></script>
		<script src="js/common-scripts.js"></script>
		<script src="js/vue.js"></script>
		<script src="js/common.js?verson=1"></script>
		<script>
			tb.isLogin("school-setting.html");
			$("td,th").addClass("text-center");
			var v = new Vue({
				el: '#school-setting',
				data: {
					admin: sessionStorage.getItem("admin"),
					ap_list: sessionStorage.getItem("ap_list"),
					gw_regionid: sessionStorage.getItem("gw_regionid"),
					allSort: [],
					subject: [],
					subject1: [],
					count: 0,
					dId: '',
					eId: '',
					schoolid: 0,
					school_name: '',
					school_remarks: '',
					currentId: 0,
					currentSubId: '',
					opened: 0,
					name: '',
					sort: '',
					state: '',
					pageNum: 0,
					pageSize: 10,
					allPage: 0,
					add: false,
					current_index: '',
					current_row: '',
					index: 0,
					close: false
				},
				created: function() {
					this.getDatalist();					
				},
				methods: {					
					getDatalist: function() {
						var that = this;					
						$.get(url + "school/listSchoolSetting", {
							pageNum: 0,
							pageSize: 10000000
						}, function(result) {
							//console.log(result)
							that.pageNum = 0;
							that.arr = Array();
							for(var i = 0; i < result.data.length; i++) {
									result.data[i].oid = result.data[i].id;
									result.data[i].str_init = '';
									result.data[i].str_parameters = '';
									result.data[i].schoolName1 = '<div onclick="loadCourses('+result.data[i].id+',\''+result.data[i].schoolName+'\')"><div style="display:inline-block;">'+result.data[i].schoolName+'</div><div style="display:inline-block;margin-left:10px;" id="s_'+result.data[i].id+'">+</div></div>';
									switch(result.data[i].type)
									{
											case 1:
													result.data[i].str_init = result.data[i].startDate+'|'+result.data[i].endDate+'|'+result.data[i].parameters;
													if (result.data[i].parameters)
													{
															result.data[i].str_parameters = '合同周期从'+that.getTime(result.data[i].startDate)+'到'+that.getTime(result.data[i].endDate)+'，成本为课程原价'+result.data[i].parameters+'%。';
													}
											break;
											case 2:
													result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
													if (result.data[i].parameters)
													{
															arr = result.data[i].parameters.split("|");
															result.data[i].str_parameters = '合同周期从'+that.getTime(result.data[i].startDate)+'到'+that.getTime(result.data[i].endDate)+'，成本为课程原价'+arr[0]+'%。';
															var arr1 = arr[1].split("/");
															var str_txt = '额外每人补贴$'+arr1[0]+'（总人数超过'+arr1[2]+'人）';															
															if (arr[2] != null)
															{
																	arr1 = arr[2].split("/");
																	str_txt += '或额外每人补贴$'+arr1[0]+'（总人数超过'+arr1[2]+'人）';
															}
															if (arr[3] != null)
															{
																	arr1 = arr[3].split("/");
																	str_txt += '或额外每人补贴$'+arr1[0]+'（总人数超过'+arr1[2]+'人）';
															}
															if (arr[4] != null)
															{
																	arr1 = arr[4].split("/");
																	str_txt += '或额外每人补贴$'+arr1[0]+'（总人数超过'+arr1[2]+'人）';
															}
															result.data[i].str_parameters += str_txt;															
													}
											break;
											case 3:
													result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
													if (result.data[i].parameters)
													{
															arr = null;
															arr = result.data[i].parameters.split("|");
															result.data[i].str_parameters = '合同周期从'+that.getTime(result.data[i].startDate)+'到'+that.getTime(result.data[i].endDate)+'，成本为课程原价'+arr[0]+'%。';
															var arr1 = arr[1].split("/");
															if (arr1[1] != null)
															{
																	var str_txt = '总人数超过'+arr1[1]+'人一次性补贴$'+arr1[0];
																	result.data[i].str_parameters += str_txt;
															}																										
													}
											break;
											case 4:
													result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
													if (result.data[i].parameters)
													{
															arr = null;
															arr = result.data[i].parameters.split("|");
															result.data[i].str_parameters = '合同周期从'+that.getTime(result.data[i].startDate)+'到'+that.getTime(result.data[i].endDate)+'。';
															var arr1 = arr[1].split("/");
															var str_txt = '成本比例为'+arr1[0]+'%（总人数达到'+arr1[1]+'人）';															
															if (arr[2] != null)
															{
																	arr1 = arr[2].split("/");
																	str_txt += '或成本比例为'+arr1[0]+'%（总人数达到'+arr1[1]+'人）';
															}
															if (arr[3] != null)
															{
																	arr1 = arr[3].split("/");
																	str_txt += '或成本比例为'+arr1[0]+'%（总人数达到'+arr1[1]+'人）';
															}
															if (arr[4] != null)
															{
																	arr1 = arr[4].split("/");
																	str_txt += '或成本比例为'+arr1[0]+'%（总人数达到'+arr1[1]+'人）';
															}
															result.data[i].str_parameters += str_txt;
													}
											break;
											case 7:													
													result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
													result.data[i].str_parameters = '合同周期从'+that.getTime(result.data[i].startDate)+'到'+that.getTime(result.data[i].endDate)+'，成本为固定价，请设置课程价目表。<a href="javascript:v.schoolid = '+result.data[i].id+';v.school_name = \''+result.data[i].schoolName+'\';loadschoolsubject_7();">课程列表</a>';
											break;
											case 5:
													result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
													if (result.data[i].parameters)
													{
															arr = null;
															arr = result.data[i].parameters.split("|");
															result.data[i].str_parameters = '合同周期从'+that.getTime(result.data[i].startDate)+'到'+that.getTime(result.data[i].endDate)+'。成本为固定值，请设置课程价目表。';
															var arr1 = arr[1].split("/");
															var str_txt = '额外每人补贴$'+arr1[1]+'（总人数超过'+arr1[0]+'人）';															
															if (arr[2] != null)
															{
																	arr1 = arr[2].split("/");
																	str_txt += '或额外每人补贴$'+arr1[1]+'（总人数超过'+arr1[0]+'人）';
															}
															if (arr[3] != null)
															{
																	arr1 = arr[3].split("/");
																	str_txt += '或额外每人补贴$'+arr1[1]+'（总人数超过'+arr1[0]+'人）';
															}
															if (arr[4] != null)
															{
																	arr1 = arr[4].split("/");
																	str_txt += '或额外每人补贴$'+arr1[1]+'（总人数超过'+arr1[0]+'人）';
															}
															result.data[i].str_parameters += str_txt+'<a href="javascript:v.schoolid = '+result.data[i].id+';v.school_name = \''+result.data[i].schoolName+'\';loadschoolsubject_7();">课程列表</a>';
													}
											break;
											case 6:
													result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
													if (result.data[i].parameters)
													{
															arr = null;
															result.data[i].str_parameters = '合同周期从'+that.getTime(result.data[i].startDate)+'到'+that.getTime(result.data[i].endDate)+'。成本为固定值，请设置课程价目表。';
															var arr1 = result.data[i].parameters.split("/");
															if (arr1[1] != null)
															{
																	var str_txt = '总人数超过'+arr1[1]+'人一次性补贴$'+arr1[0];
																	result.data[i].str_parameters += str_txt;
															}																										
													}
											break;
									}									
									result.data[i].str_type = sltype(result.data[i].type,result.data[i].id,result.data[i].str_init,result.data[i].schoolName);
									//result.data[i].str_type = '';
									//result.data[i].str_parameters = '';
									result.data[i].attachments = '';
									result.data[i].str_flist = '';																
									if (result.data[i].schoolAttachments != null)
									{
											if (result.data[i].schoolAttachments.remarks != null) result.data[i].str_remarks = result.data[i].schoolAttachments.remarks;
											if (result.data[i].schoolAttachments.contractFile1 != null)
											{
													result.data[i].attachments += '<a href="/statics'+result.data[i].schoolAttachments.contractFile1+'" target="_blank">合同1</a>&nbsp;&nbsp;';
													result.data[i].str_flist = result.data[i].schoolAttachments.contractFile1;
											}
											if (result.data[i].schoolAttachments.contractFile2 != null)
											{
													result.data[i].attachments += '<a href="/statics'+result.data[i].schoolAttachments.contractFile2+'" target="_blank">合同2</a>&nbsp;&nbsp;';
													result.data[i].str_flist += ','+result.data[i].schoolAttachments.contractFile2;
											}
											if (result.data[i].schoolAttachments.contractFile3 != null)
											{
													result.data[i].attachments += '<a href="/statics'+result.data[i].schoolAttachments.contractFile3+'" target="_blank">合同3</a>&nbsp;&nbsp;';
													result.data[i].str_flist += ','+result.data[i].schoolAttachments.contractFile3;
											}
									}
							};
							that.subject = result.data;
							//console.log(that.subject);
						});
					},
					getSchoolSubject: function() {
						var that = this;						
						$.get(url + "school/listSubjectSetting?schoolSettingId="+that.schoolid, {
							pageNum: 0,
							pageSize: 1000
						}, function(result) {
							//console.log(result)
							that.pageNum = 0;
							for(var i = 0; i < result.data.length; i++) {
									result.data[i].oid = result.data[i].id;
									result.data[i].price = '<input type="text" id="price'+result.data[i].id+'" name="'+result.data[i].id+'" value="'+result.data[i].price+'"" />';
							};
							that.subject1 = result.data;
							//console.log(that.subject);
						});
					},
					getTime: function(d) {
						var date1 = new Date(d);
						var y = date1.getFullYear();
						var m = this.addZero(date1.getMonth() + 1);
						var d = this.addZero(date1.getDate());
						var h = this.addZero(date1.getHours());
						var m2 = this.addZero(date1.getMinutes());
						var s = this.addZero(date1.getSeconds());
						//var date2 = y + "-" + m + "-" + d;
						var date2 = d+"/"+m+"/"+y;
						return date2;
					},
					addZero: function(obj) {
						if(obj < 10) {
							obj = '0' + obj;
						};
						return obj;
					}					
				}		
			});						
						
			function loadCourses(id,name)
			{
					if (v.currentId)
					{
							var str = v.currentSubId.toString();
							var arr = str.split(',');
							for(var i=0;i < arr.length;i++)
							{
									$("#sub_"+arr[i]).remove();
							}
							$('#s_'+v.currentId).html('+');	
							v.opened = 0;
					}
					if (!v.opened)
					{
							$('#s_'+id).html('-');
							v.opened = 1;
							//ajax请求课程
							ajaxGetCourses(id,name);
					}
					v.currentId = id;					
			}
			
			function ajaxGetCourses(id,name)
			{
					$.get(url + "school/listSchoolSetting?schoolName="+name, {
						pageNum: 0,
						pageSize: 100000
					}, function(result) {
						var str_html = '';
						if (result.data != null)
						{
								for(var i = 0; i < result.data.length; i++) {
										result.data[i].oid = result.data[i].id;
										if (result.data[i].schoolSubject != '')
										{
												result.data[i].str_init = '';
												result.data[i].str_parameters = '';
												switch(result.data[i].type)
												{
														case 1:
																result.data[i].str_init = result.data[i].startDate+'|'+result.data[i].endDate+'|'+result.data[i].parameters;
																if (result.data[i].parameters)
																{
																		result.data[i].str_parameters = '合同周期从'+v.getTime(result.data[i].startDate)+'到'+v.getTime(result.data[i].endDate)+'，成本为课程原价'+result.data[i].parameters+'%。';
																}
														break;
														case 2:
																result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
																if (result.data[i].parameters)
																{
																		arr = result.data[i].parameters.split("|");
																		result.data[i].str_parameters = '合同周期从'+v.getTime(result.data[i].startDate)+'到'+v.getTime(result.data[i].endDate)+'，成本为课程原价'+arr[0]+'%。';
																		var arr1 = arr[1].split("/");
																		var str_txt = '额外每人补贴$'+arr1[0]+'（总人数超过'+arr1[2]+'人）';															
																		if (arr[2] != null)
																		{
																				arr1 = arr[2].split("/");
																				str_txt += '或额外每人补贴$'+arr1[0]+'（总人数超过'+arr1[2]+'人）';
																		}
																		if (arr[3] != null)
																		{
																				arr1 = arr[3].split("/");
																				str_txt += '或额外每人补贴$'+arr1[0]+'（总人数超过'+arr1[2]+'人）';
																		}
																		if (arr[4] != null)
																		{
																				arr1 = arr[4].split("/");
																				str_txt += '或额外每人补贴$'+arr1[0]+'（总人数超过'+arr1[2]+'人）';
																		}
																		result.data[i].str_parameters += str_txt;															
																}
														break;
														case 3:
																result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
																if (result.data[i].parameters)
																{
																		arr = null;
																		arr = result.data[i].parameters.split("|");
																		result.data[i].str_parameters = '合同周期从'+v.getTime(result.data[i].startDate)+'到'+v.getTime(result.data[i].endDate)+'，成本为课程原价'+arr[0]+'%。';
																		var arr1 = arr[1].split("/");
																		if (arr1[1] != null)
																		{
																				var str_txt = '总人数超过'+arr1[0]+'人一次性补贴$'+arr1[1];
																				result.data[i].str_parameters += str_txt;
																		}																										
																}
														break;
														case 4:
																result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
																if (result.data[i].parameters)
																{
																		arr = null;
																		arr = result.data[i].parameters.split("|");
																		result.data[i].str_parameters = '合同周期从'+v.getTime(result.data[i].startDate)+'到'+v.getTime(result.data[i].endDate)+'。';
																		var arr1 = arr[1].split("/");
																		var str_txt = '成本比例为'+arr1[0]+'%（总人数达到'+arr1[1]+'人）';															
																		if (arr[2] != null)
																		{
																				arr1 = arr[2].split("/");
																				str_txt += '或成本比例为'+arr1[0]+'%（总人数达到'+arr1[1]+'人）';
																		}
																		if (arr[3] != null)
																		{
																				arr1 = arr[3].split("/");
																				str_txt += '或成本比例为'+arr1[0]+'%（总人数达到'+arr1[1]+'人）';
																		}
																		if (arr[4] != null)
																		{
																				arr1 = arr[4].split("/");
																				str_txt += '或成本比例为'+arr1[0]+'%（总人数达到'+arr1[1]+'人）';
																		}
																		result.data[i].str_parameters += str_txt;
																}
														break;
														case 7:													
																result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
																result.data[i].str_parameters = '合同周期从'+v.getTime(result.data[i].startDate)+'到'+v.getTime(result.data[i].endDate)+'，成本为固定价：'+result.data[i].parameters+'。';
														break;
														case 5:
																result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
																if (result.data[i].parameters)
																{
																		arr = null;
																		arr = result.data[i].parameters.split("|");
																		result.data[i].str_parameters = '合同周期从'+v.getTime(result.data[i].startDate)+'到'+v.getTime(result.data[i].endDate)+'。成本为固定值，请设置课程价目表。';
																		var arr1 = arr[1].split("/");
																		var str_txt = '额外每人补贴$'+arr1[1]+'（总人数超过'+arr1[0]+'人）';															
																		if (arr[2] != null)
																		{
																				arr1 = arr[2].split("/");
																				str_txt += '或额外每人补贴$'+arr1[1]+'（总人数超过'+arr1[0]+'人）';
																		}
																		if (arr[3] != null)
																		{
																				arr1 = arr[3].split("/");
																				str_txt += '或额外每人补贴$'+arr1[1]+'（总人数超过'+arr1[0]+'人）';
																		}
																		if (arr[4] != null)
																		{
																				arr1 = arr[4].split("/");
																				str_txt += '或额外每人补贴$'+arr1[1]+'（总人数超过'+arr1[0]+'人）';
																		}
																		result.data[i].str_parameters += str_txt+'<a href="javascript:v.schoolid = '+result.data[i].id+';v.school_name = \''+result.data[i].schoolName+'\';loadschoolsubject_7();">课程列表</a>';
																}
														break;
														case 6:
																result.data[i].str_init = result.data[i].startDate+'#'+result.data[i].endDate+'#'+result.data[i].parameters;
																if (result.data[i].parameters)
																{
																		arr = null;
																		result.data[i].str_parameters = '合同周期从'+v.getTime(result.data[i].startDate)+'到'+v.getTime(result.data[i].endDate)+'。成本为固定值，请设置课程价目表。';
																		var arr1 = result.data[i].parameters.split("/");
																		if (arr1[1] != null)
																		{
																				var str_txt = '总人数超过'+arr1[1]+'人一次性补贴$'+arr1[0];
																				result.data[i].str_parameters += str_txt;
																		}																										
																}
														break;
												}									
												result.data[i].str_type = sltype(result.data[i].type,result.data[i].id,result.data[i].str_init,result.data[i].schoolName);
												if (v.currentSubId == '')
												{
														v.currentSubId = result.data[i].id;
												}else
												{
														v.currentSubId += ','+result.data[i].id;
												}
												$("#list_"+id).after('<tr id="sub_'+result.data[i].id+'"><td></td><td align="center" style="color:#000;">'+result.data[i].schoolSubject+'</td><td>'+result.data[i].str_type+'</td><td style="color:#008000;">'+result.data[i].str_parameters +'</td><td></td><td></td></tr>');
										}
								}
						}
					});
			}						
			
			function sltype(type,sid,str_init,school_name)
			{	
					var str_html = '<select id="sl_type" name="sl_type" onchange="showbox(this.value,'+type+','+sid+',\''+str_init+'\',\''+school_name+'\')">';
					str_html += '<option value="Select One...">Select One...</option>';
          str_html += '<option';
          if (type == 1) str_html += ' SELECTED="true"';
          str_html += ' value="1">固定比例（无额外补贴）</option>';
          str_html += '<option';
          if (type == 2) str_html += ' SELECTED="true"';
          str_html += ' value="2">固定比例+每人补贴</option>';
          /*
          str_html += '<option';
          if (type == 3) str_html += ' SELECTED="true"';
          str_html += ' value="3">固定比例+固定一次性补贴</option>';
          */
          str_html += '<option';
          if (type == 4) str_html += ' SELECTED="true"';
          str_html += ' value="4">变动比例</option>';          
          str_html += '<option';
          if (type == 7) str_html += ' SELECTED="true"';
          str_html += ' value="7">固定底价（无额外补贴）</option>';
          /*
          str_html += '<option';
          if (type == 5) str_html += ' SELECTED="true"';
          str_html += ' value="5">固定底价+每人补贴</option>';
          str_html += '<option';
          if (type == 6) str_html += ' SELECTED="true"';
          str_html += ' value="6">固定底价+固定一次性补贴</option>';*/
        	str_html += '</select>';
        	return str_html;
			}
			
			function showbox(t,current_type,id,str_init,school_name)
			{
					var arr = Array();
					v.dId = id;
					v.school_name = school_name;	
					switch(parseInt(t))
					{
							case 1:
									$('#type1_id').modal('show');
									$('#t1a1').val('');
									$('#t1a2').val('');
									$('#t1b1').val('');
									if (t == current_type && str_init.length)
									{
											arr = str_init.split("|");
											$('#t1a1').val(formatDate(parseInt(arr[0])));
											$('#t1a2').val(formatDate(parseInt(arr[1])));
											$('#t1b1').val(arr[2]);
									}
							break;
							case 2:
									$('#type2_id').modal('show');
									$('#t2a1').val('');
									$('#t2a2').val('');
									$('#t2b1').val('');
									$('#t2c1').val('');
									$('#t2c2').val('');
									$('#t2c3').val('');
									$('#t2d1').val('');
									$('#t2d2').val('');
									$('#t2d3').val('');
									$('#t2e1').val('');
									$('#t2e2').val('');
									$('#t2e3').val('');
									$('#t2f1').val('');
									$('#t2f2').val('');
									$('#t2f3').val('');
									if (t == current_type && str_init.length)
									{
											arr = str_init.split("#");
											$('#t2a1').val(formatDate(parseInt(arr[0])));
											$('#t2a2').val(formatDate(parseInt(arr[1])));
											var arr1 = arr[2].split("|");
											$('#t2b1').val(arr1[0]);
											var arrc = arr1[1].split("/");
											$('#t2c1').val(arrc[0]);
											$('#t2c2').val(arrc[1]);
											$('#t2c3').val(arrc[2]);
											if (typeof(arr1[2]) != "undefined") 
											{
													var arrd = arr1[2].split("/");
													$('#t2d1').val(arrd[0]);
													$('#t2d2').val(arrd[1]);
													$('#t2d3').val(arrd[2]);
											}
											if (typeof(arr1[3]) != "undefined") 
											{
													var arre = arr1[3].split("/");
													$('#t2e1').val(arre[0]);
													$('#t2e2').val(arre[1]);
													$('#t2e3').val(arre[2]);
											}
											if (typeof(arr1[4]) != "undefined") 
											{
													var arrf = arr1[4].split("/");
													$('#t2f1').val(arrf[0]);
													$('#t2f2').val(arrf[1]);
													$('#t2f3').val(arrf[2]);
											}
									}
							break;
							case 3:
									$('#type3_id').modal('show');
									$('#t3a1').val('');
									$('#t3a2').val('');
									$('#t3b1').val('');
									$('#t3c1').val('');
									$('#t3c2').val('');
									if (t == current_type && str_init.length)
									{
											arr = str_init.split("#");
											$('#t3a1').val(formatDate(parseInt(arr[0])));
											$('#t3a2').val(formatDate(parseInt(arr[1])));
											var arr1 = arr[2].split("|");
											$('#t3b1').val(arr1[0]);
											var arrc = arr1[1].split("/");
											$('#t3c1').val(arrc[1]);
											$('#t3c2').val(arrc[0]);
									}
							break;
							case 4:
									$('#type4_id').modal('show');
									$('#t4a1').val('');
									$('#t4a2').val('');
									$('#t4b1').val('');
									$('#t4b2').val('');
									$('#t4c1').val('');
									$('#t4c2').val('');
									$('#t4d1').val('');
									$('#t4d2').val('');
									$('#t4e1').val('');
									$('#t4e2').val('');
									if (t == current_type && str_init.length)
									{
											arr = str_init.split("#");
											$('#t4a1').val(formatDate(parseInt(arr[0])));
											$('#t4a2').val(formatDate(parseInt(arr[1])));
											var arr1 = arr[2].split("|");
											if (typeof(arr1[1]) != "undefined") 
											{
													var arrb = arr1[1].split("/");											
													$('#t4b1').val(arrb[0]);
													$('#t4b2').val(arrb[1]);
											}
											if (typeof(arr1[2]) != "undefined") 
											{
													var arrc = arr1[2].split("/");
													$('#t4c1').val(arrc[0]);
													$('#t4c2').val(arrc[1]);
											}
											if (typeof(arr1[3]) != "undefined") 
											{
													var arrd = arr1[3].split("/");
													$('#t4d1').val(arrd[0]);
													$('#t4d2').val(arrd[1]);
											}
											if (typeof(arr1[4]) != "undefined") 
											{
													var arre = arr1[4].split("/");
													$('#t4e1').val(arre[0]);
													$('#t4e2').val(arre[1]);
											}
									}
							break;
							case 7:
									$('#type7_id').modal('show');	
									$('#t7a1').val('');
									$('#t7a2').val('');
									if (t == current_type && str_init.length)
									{
											arr = str_init.split("#");
											$('#t7a1').val(formatDate(parseInt(arr[0])));
											$('#t7a2').val(formatDate(parseInt(arr[1])));
											$('#t7a3').val(arr[2]);
									}								
									v.schoolid = id;
							break;
							case 5:
									$('#type5_id').modal('show');
									$('#t5a1').val('');
									$('#t5a2').val('');
									if (t == current_type && str_init.length)
									{
											arr = str_init.split("#");
											$('#t5a1').val(formatDate(parseInt(arr[0])));
											$('#t5a2').val(formatDate(parseInt(arr[1])));
											var arr1 = arr[2].split("|");
											if (typeof(arr1[1]) != "undefined") 
											{
													var arrb = arr1[1].split("/");											
													$('#t5b1').val(arrb[0]);
													$('#t5b2').val(arrb[1]);
											}
											if (typeof(arr1[2]) != "undefined") 
											{
													var arrc = arr1[2].split("/");
													$('#t5c1').val(arrc[0]);
													$('#t5c2').val(arrc[1]);
											}
											if (typeof(arr1[3]) != "undefined") 
											{
													var arrd = arr1[3].split("/");
													$('#t5d1').val(arrd[0]);
													$('#t5d2').val(arrd[1]);
											}
											if (typeof(arr1[2]) != "undefined") 
											{
													var arre = arr1[4].split("/");
													$('#t5e1').val(arre[0]);
													$('#t5e2').val(arre[1]);
											}
									}								
									v.schoolid = id;
							break;
							case 6:
									$('#type6_id').modal('show');
									$('#t6a1').val('');
									$('#t6a2').val('');
									if (t == current_type && str_init.length)
									{
											arr = str_init.split("#");
											$('#t6a1').val(formatDate(parseInt(arr[0])));
											$('#t6a2').val(formatDate(parseInt(arr[1])));
											var arr1 = arr[2].split("|");
											var arrb = arr1[0].split("/");											
											$('#t6b1').val(arrb[1]);
											$('#t6b2').val(arrb[0]);											
									}								
									v.schoolid = id;
							break;
					}
			}
			
			function loadschoolsubject_7()
			{
					v.getSchoolSubject();
					$('#type7a_id').modal('show');
					$('#schoolname_7a').html(v.school_name);
			}
			
			function loadschoolsubject_5()
			{
					v.getSchoolSubject();
					$('#type5a_id').modal('show');
					$('#schoolname_5a').html(v.school_name);
			}
			
			function loadschoolsubject_6()
			{
					v.getSchoolSubject();
					$('#type6a_id').modal('show');
					$('#schoolname_6a').html(v.school_name);
			}
			
			function type1_SetSave()
			{
					var jqInputs = $('input',$("#type1_id"));
					var arr_d = Array();
					var str_d = '';
					var date = new Date();
					var a1 = 0;
					if (jqInputs[0].value != '')
          {
          		arr_d = jqInputs[0].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a1 = date.getTime();
        	}
        	var a2 = 0;
        	if (jqInputs[1].value != '')
          {
          		arr_d = jqInputs[1].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a2 = date.getTime();
        	}
        	var b1 = jqInputs[2].value;
        	var check_result = 0;
          if (jqInputs[0].value != '' && jqInputs[1].value != '' && jqInputs[2].value != '')
          {
          		check_result = true;
          }else
          {
          		alert('所有选项必须填写！');
          }
          
          if (check_result)
          {
          		var str_url = url + "school/updateSchoolSetting1";
              var sa_id = v.dId;
              
              $.post(str_url, { id: sa_id, startDate: a1, endDate: a2, proportion: b1},
					   	function(data){
					   			if (data.code == 0)
					   			{
					   					$('#type1_id').modal('hide');
					   					v.add = false;
					   					$('.alert').addClass('alert-success').show().delay(1500).fadeOut();			   					
					   					//重新载入数据源
					   					v.getDatalist();
					   			}else
					   			{
					   					$('#alert_error').addClass('alert-danger').show().delay(3000).fadeOut();
			          			$("#error_info").html(data.message);
				        			return false;
					   			}
					   			//console.log(data);
					   	});     
          }
			}	
			
			function type2_SetSave()
			{
					var jqInputs = $('input',$("#type2_id"));
					var arr_d = Array();
					var str_d = '';
					var date = new Date();
					var a1 = 0;
					if (jqInputs[0].value != '')
          {
          		arr_d = jqInputs[0].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a1 = date.getTime();
        	}
        	var a2 = 0;
        	if (jqInputs[1].value != '')
          {
          		arr_d = jqInputs[1].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a2 = date.getTime();
        	}
        	var b1 = jqInputs[2].value;
        	var c1 = jqInputs[3].value;
        	var c2 = jqInputs[4].value;
        	var c3 = jqInputs[5].value;
        	var d1 = jqInputs[6].value;
        	var d2 = jqInputs[7].value;
        	var d3 = jqInputs[8].value;
        	var e1 = jqInputs[9].value;
        	var e2 = jqInputs[10].value;
        	var e3 = jqInputs[11].value;
        	var f1 = jqInputs[12].value;
        	var f2 = jqInputs[13].value;
        	var f3 = jqInputs[14].value;
        	
        	var check_result = 0;
          if (jqInputs[0].value != '' && jqInputs[1].value != '' && jqInputs[2].value != '' && jqInputs[3].value != '' && jqInputs[4].value != '' && jqInputs[4].value != '')
          {
          		check_result = true;
          }else
          {
          		alert('有必填项为空，请填写！');
          }
          
          if (check_result)
          {
          		var str_url = url + "school/updateSchoolSetting2";
              var sa_id = v.dId;
              
              $.post(str_url, { id: sa_id, startDate: a1, endDate: a2, proportion: b1, fee1: c1, number1_1: c2, number1_2: c3, fee2: d1, number2_1: d2, number2_2: d3, fee3: e1, number3_1: e2, number3_2: e3, fee4: f1, number4_1: f2, number4_2: f3},
					   	function(data){
					   			if (data.code == 0)
					   			{
					   					$('#type2_id').modal('hide');
					   					v.add = false;
					   					$('.alert').addClass('alert-success').show().delay(1500).fadeOut();					   					
					   					//重新载入数据源
					   					v.getDatalist();
					   			}
					   			//console.log(data);
					   	});     
          }
			}
			
			function type3_SetSave()
			{
					var jqInputs = $('input',$("#type3_id"));
					var arr_d = Array();
					var str_d = '';
					var date = new Date();
					var a1 = 0;
					if (jqInputs[0].value != '')
          {
          		arr_d = jqInputs[0].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a1 = date.getTime();
        	}
        	var a2 = 0;
        	if (jqInputs[1].value != '')
          {
          		arr_d = jqInputs[1].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a2 = date.getTime();
        	}
        	var b1 = jqInputs[2].value;
        	var c1 = jqInputs[3].value;
        	var c2 = jqInputs[4].value;
        	var check_result = 0;
          if (jqInputs[0].value != '' && jqInputs[1].value != '' && jqInputs[2].value != '' && jqInputs[3].value != '' && jqInputs[4].value != '')
          {
          		check_result = true;
          }else
          {
          		alert('所有选项必须填写！');
          }
          
          if (check_result)
          {
          		var str_url = url + "school/updateSchoolSetting3";
              var sa_id = v.dId;
              
              $.post(str_url, { id: sa_id, startDate: a1, endDate: a2, proportion: b1, number: c1, fee: c2},
					   	function(data){
					   			if (data.code == 0)
					   			{
					   					$('#type3_id').modal('hide');
					   					v.add = false;
					   					$('.alert').addClass('alert-success').show().delay(1500).fadeOut();					   					
					   					//重新载入数据源
					   					v.getDatalist();
					   			}
					   			//console.log(data);
					   	});     
          }
			}
			
			function type4_SetSave()
			{
					var jqInputs = $('input',$("#type4_id"));
					var arr_d = Array();
					var str_d = '';
					var date = new Date();
					var a1 = 0;
					if (jqInputs[0].value != '')
          {
          		arr_d = jqInputs[0].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a1 = date.getTime();
        	}
        	var a2 = 0;
        	if (jqInputs[1].value != '')
          {
          		arr_d = jqInputs[1].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a2 = date.getTime();
        	}
        	var b1 = jqInputs[2].value;
        	var b2 = jqInputs[3].value;
        	var c1 = jqInputs[4].value;
        	var c2 = jqInputs[5].value;
        	var d1 = jqInputs[6].value;
        	var d2 = jqInputs[7].value;
        	var e1 = jqInputs[8].value;
        	var e2 = jqInputs[9].value;
        	var check_result = 0;
          if (jqInputs[0].value != '' && jqInputs[1].value != '' && jqInputs[2].value != '' && jqInputs[3].value != '')
          {
          		check_result = true;
          }else
          {
          		alert('所有选项必须填写！');
          }
          
          if (check_result)
          {
          		var str_url = url + "school/updateSchoolSetting4";
              var sa_id = v.dId;
              
              $.post(str_url, { id: sa_id, startDate: a1, endDate: a2, number1: b1, proportion1: b2, number2: c1, proportion2: c2, number3: d1, proportion3: d2, number4: e1, proportion4: e2},
					   	function(data){
					   			if (data.code == 0)
					   			{
					   					$('#type4_id').modal('hide');
					   					v.add = false;
					   					$('.alert').addClass('alert-success').show().delay(1500).fadeOut();					   					
					   					//重新载入数据源
					   					v.getDatalist();
					   			}
					   			//console.log(data);
					   	});     
          }
			}
			
			function type7_SetSave()
			{
					var jqInputs = $('input',$("#type7_id"));
					var arr_d = Array();
					var str_d = '';
					var date = new Date();
					var a1 = 0;
					if (jqInputs[0].value != '')
          {
          		arr_d = jqInputs[0].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a1 = date.getTime();
        	}
        	var a2 = 0;
        	if (jqInputs[1].value != '')
          {
          		arr_d = jqInputs[1].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a2 = date.getTime();
        	}
        	var check_result = 0;
          if (jqInputs[0].value != '' && jqInputs[1].value != '' && jqInputs[2].value != '')
          {
          		check_result = true;
          }else
          {
          		alert('所有选项必须填写！');
          }
          
          if (check_result)
          {
          		var str_url = url + "school/updateSchoolSetting7";
              var sa_id = v.dId;
              
              $.post(str_url, { id: sa_id, startDate: a1, endDate: a2, fee: jqInputs[2].value},
					   	function(data){
					   			if (data.code == 0)
					   			{
					   					$('#type7_id').modal('hide');
					   					$('.alert').addClass('alert-success').show().delay(1500).fadeOut();					   					
					   					//重新载入数据源
					   					v.getDatalist();
					   			}
					   			//console.log(data);
					   	});     
          }
			}
			
			function type7a_SetSave()
			{
					var jqInputs = $('input',$("#type7a_id"));
					var str_field = '';
					for(var x=0; x<jqInputs.length;x++)
					{
							if ((x+1) == jqInputs.length)
							{
									str_field += jqInputs[x].name+':'+jqInputs[x].value;
							}else
							{
									str_field += jqInputs[x].name+':'+jqInputs[x].value+'|';
							}
			    }
			    
			    var str_url = url + "school/updateSubjectSettings";
          
          $.post(str_url, {parameters: str_field},
			   	function(data){
			   			if (data.code == 0)
			   			{
			   					$('#type7a_id').modal('hide');
			   					$('.alert').addClass('alert-success').show().delay(1500).fadeOut();			   					
			   			}
			   			//console.log(data);
			   	});     
					
			}
			
			function type5_SetSave()
			{
					var jqInputs = $('input',$("#type5_id"));
					var arr_d = Array();
					var str_d = '';
					var date = new Date();
					var a1 = 0;
					if (jqInputs[0].value != '')
          {
          		arr_d = jqInputs[0].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a1 = date.getTime();
        	}
        	var a2 = 0;
        	if (jqInputs[1].value != '')
          {
          		arr_d = jqInputs[1].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a2 = date.getTime();
        	}
        	var b1 = jqInputs[2].value;
        	var b2 = jqInputs[3].value;
        	var c1 = jqInputs[4].value;
        	var c2 = jqInputs[5].value;
        	var d1 = jqInputs[6].value;
        	var d2 = jqInputs[7].value;
        	var e1 = jqInputs[8].value;
        	var e2 = jqInputs[9].value;        	
        	
        	var check_result = 0;
          if (jqInputs[0].value != '' && jqInputs[1].value != '' && b1 && b2)
          {
          		check_result = true;
          }else
          {
          		alert('所有选项必须填写！');
          }
          
          if (check_result)
          {
          		var str_url = url + "school/updateSchoolSetting5";
              var sa_id = v.dId;
              
              $.post(str_url, { id: sa_id, startDate: a1, endDate: a2, number1: b1, fee1: b2, number2: c1, fee2: c2, number3: d1, fee3: d2, number4: e1, fee4: e2},
					   	function(data){
					   			if (data.code == 0)
					   			{
					   					$('#type5_id').modal('hide');
					   					$('.alert').addClass('alert-success').show().delay(1500).fadeOut();					   					
					   					//重新载入数据源
					   					v.getDatalist();
					   			}
					   			//console.log(data);
					   	});     
          }
			}
			
			function type5a_SetSave()
			{
					var jqInputs = $('input',$("#type5a_id"));
					var str_field = '';
					for(var x=0; x<jqInputs.length;x++)
					{
							if ((x+1) == jqInputs.length)
							{
									str_field += jqInputs[x].name+':'+jqInputs[x].value;
							}else
							{
									str_field += jqInputs[x].name+':'+jqInputs[x].value+'|';
							}
			    }
			    
			    var str_url = url + "school/updateSubjectSettings";
          
          $.post(str_url, {parameters: str_field},
			   	function(data){
			   			if (data.code == 0)
			   			{
			   					$('#type5a_id').modal('hide');
			   					$('.alert').addClass('alert-success').show().delay(1500).fadeOut();			   					
			   			}
			   			//console.log(data);
			   	});     
					
			}
			
			function type6_SetSave()
			{
					var jqInputs = $('input',$("#type6_id"));
					var arr_d = Array();
					var str_d = '';
					var date = new Date();
					var a1 = 0;
					if (jqInputs[0].value != '')
          {
          		arr_d = jqInputs[0].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a1 = date.getTime();
        	}
        	var a2 = 0;
        	if (jqInputs[1].value != '')
          {
          		arr_d = jqInputs[1].value.split("/");
      				str_d = arr_d[2]+'-'+arr_d[1]+'-'+arr_d[0];
              date = new Date(str_d);
              a2 = date.getTime();
        	}
        	var b1 = jqInputs[2].value;
        	var b2 = jqInputs[3].value;        	
        	
        	var check_result = 0;
          if (jqInputs[0].value != '' && jqInputs[1].value != '' && b1 && b2)
          {
          		check_result = true;
          }else
          {
          		alert('所有选项必须填写！');
          }
          
          if (check_result)
          {
          		var str_url = url + "school/updateSchoolSetting6";
              var sa_id = v.dId;
              
              $.post(str_url, { id: sa_id, startDate: a1, endDate: a2, number: b1, fee: b2},
					   	function(data){
					   			if (data.code == 0)
					   			{
					   					$('#type6_id').modal('hide');
					   					$('.alert').addClass('alert-success').show().delay(1500).fadeOut();					   					
					   					//重新载入数据源
					   					v.getDatalist();
					   			}
					   			//console.log(data);
					   	});     
          }
			}
			
			function type6a_SetSave()
			{
					var jqInputs = $('input',$("#type6a_id"));
					var str_field = '';
					for(var x=0; x<jqInputs.length;x++)
					{
							if ((x+1) == jqInputs.length)
							{
									str_field += jqInputs[x].name+':'+jqInputs[x].value;
							}else
							{
									str_field += jqInputs[x].name+':'+jqInputs[x].value+'|';
							}
			    }
			    
			    var str_url = url + "school/updateSubjectSettings";
          
          $.post(str_url, {parameters: str_field},
			   	function(data){
			   			if (data.code == 0)
			   			{
			   					$('#type6a_id').modal('hide');
			   					$('.alert').addClass('alert-success').show().delay(1500).fadeOut();			   					
			   			}
			   			//console.log(data);
			   	});     
					
			}
			
			function show_update_remarks(id,name)
			{
					$('#school_remarks #schoolName').html(name);
					$('#school_remarks #school_name').val(name);
					$('#school_remarks #remarks').val($('#example #remarks'+id).html());
					v.schoolid = id;
					$('#school_remarks').modal('show');
			}
			
			function updateRemarks()
			{
					var str_remarks = $('#school_remarks #remarks').val();
					if (str_remarks != '')
					{
							var json = {};
							
							var str_url = url + "school/updateSchoolAttachments";
 							json['name'] = $('#school_remarks #school_name').val();
 							json['remarks'] = str_remarks;
 							show_loading();
 							
 							$.post(str_url, json,
					   	function(data){
					   			$('#loading_id').modal('hide');
					   			if (parseInt(data.code) == 0)
					   			{
					   					$('#example #remarks'+v.schoolid).html(str_remarks);
					   					$('#school_remarks #alert_success').css('marginTop','10px');
					   					$('#school_remarks #alert_success').css('marginLeft','10%');
					   					$('#school_remarks #alert_success').addClass('alert-success').show().delay(1500).fadeOut();
					   					v.schoolid = 0;
					   					setTimeout(function(){$('#school_remarks').modal('hide');$('.modal-backdrop').remove();}, 2000);
					   			}else
					   			{
					   					$('#school_remarks #alert_error').css('marginTop','10px');
					   					$('#school_remarks #alert_error').css('marginLeft','10%');
					   					$('#school_remarks #alert_error').addClass('alert-danger').show().delay(3000).fadeOut();
			          			$("#school_remarks #error_info").html(data.message);
				        			return false;
					   			}
					   	});
					}else
					{
							$('#school_remarks #alert_error').css('marginTop','10px');
        			$('#school_remarks #alert_error').css('marginLeft','10%');
	   					$('#school_remarks #alert_error').addClass('alert-danger').show().delay(3000).fadeOut();
        			$("#school_remarks #error_info").html('备注内容不能为空！');
					}
					
			}
			
			function show_upload_attachment(name,str_flist)	
			{
					$('#school_attachments #schoolName').html(name);
					$('#school_attachments #school_name').val(name);
					$("#school_attachments #show_pic").empty();
					//初始化已上传的合同
					if (str_flist != '')
					{							
							$("#school_attachments #flist").val(str_flist);
							var arr = str_flist.split(',');
							var str_html = '';
							var t = 1;
							for(var i=0;i<arr.length;i++)
							{
									$("#school_attachments #show_pic").append('<div style="line-height:40px;" id="attach'+t+'"><a href="/statics'+arr[i]+'" target="_blank">查看合同'+t+'</a>&nbsp;&nbsp;<button onclick="upload_attachment(\'f1e'+t+'\')" id="edit_upload_attachment" type="button" class="btn btn-primary" style="">重新上传</button></div>');
									t++;
							}
							$("#school_attachments #show_pic").show();
					}else
					{
							$("#school_attachments #flist").val('');
					}
					$('#school_attachments').modal('show');
			}
			
			function upload_attachment(fname)
			{
					document.getElementById(fname).click(); 
			}
			
			function uploadAttachment()
			{
					var flist = $("#school_attachments #flist").val();
					if (flist != '')
					{
							var json = {};
							var arr = flist.split(',');
							var t = 1;
 							for(var i=0;i<arr.length;i++)
 							{
   								json['contractFile'+t] = arr[i];
   								t++;
 							}
 							
 							var str_url = url + "school/updateSchoolAttachments";
 							json['name'] = $('#school_attachments #school_name').val();
 							show_loading();
 							
 							$.post(str_url, json,
					   	function(data){
					   			$('#loading_id').modal('hide');
					   			if (parseInt(data.code) == 0)
					   			{					   					
					   					$('#school_attachments #alert_success').css('marginTop','10px');
					   					$('#school_attachments #alert_success').css('marginLeft','10%');
					   					$('#school_attachments #alert_success').addClass('alert-success').show().delay(1500).fadeOut();
					   					setTimeout(function(){$('#school_attachments').modal('hide');v.getDatalist();$('.modal-backdrop').remove();}, 2000);
					   			}else
					   			{
					   					$('#school_attachments #alert_error').css('marginTop','10px');
					   					$('#school_attachments #alert_error').css('marginLeft','10%');
					   					$('#school_attachments #alert_error').addClass('alert-danger').show().delay(3000).fadeOut();
			          			$("#school_attachments #error_info").html(data.message);
				        			return false;
					   			}
					   	});
					}else
					{
							$('#school_attachments #alert_error').css('marginTop','10px');
        			$('#school_attachments #alert_error').css('marginLeft','10%');
	   					$('#school_attachments #alert_error').addClass('alert-danger').show().delay(3000).fadeOut();
        			$("#school_attachments #error_info").html('请至少上传1个合同附件！');
					}
			}
			
			$('#school_attachments #f1').live('change', function (e) {
					var formData = new FormData();					
					formData.append("file",$("#f1")[0].files[0]);
					var flist = $("#school_attachments #flist").val();
					var arr_flist = Array();
					var i = 0;
					if (flist != '')
					{
							arr_flist = flist.split(",");
							i = arr_flist.length;
					}
					
					if (i < 3)
					{					
							$.ajax({
					        url: url + 'school/upload_contract_file',
					        dataType:'json',
					        type:'POST',
					        async: false,
					        data: formData,
					        processData : false, //使数据不做处理
					        contentType : false,
					        success: function(data){			        		
					            if (data.code == '0') {			            		
					            		if (flist)
					            		{
					            				$("#school_attachments #flist").val(flist+','+data.data);
					            		}else
					            		{
					            				$("#school_attachments #flist").val(data.data);
					            		}
							        		$("#school_attachments #show_pic").append('<a href="/statics'+data.data+'" target="_blank">查看合同</a>&nbsp;');
							        		$("#school_attachments #show_pic").show();
					            }else
					            {
					            		$('#school_attachments #alert_error').css('marginTop','10px');
					          			$('#school_attachments #alert_error').css('marginLeft','10%');
							   					$('#school_attachments #alert_error').addClass('alert-danger').show().delay(3000).fadeOut();
					          			$("#school_attachments #error_info").html('上传失败！');
					            }	
					        },
					        error:function(response){
					            console.log(response);
					        }
					    });
			  	}else
			  	{
			  			$('#school_attachments #alert_error').css('marginTop','10px');
        			$('#school_attachments #alert_error').css('marginLeft','10%');
	   					$('#school_attachments #alert_error').addClass('alert-danger').show().delay(3000).fadeOut();
        			$("#school_attachments #error_info").html('只允许最多上传3份！');
			  	}
			});
			
			$('#school_attachments #f1e1').live('change', function (e) {
					var formData = new FormData();					
					formData.append("file",$("#f1e1")[0].files[0]);
					var flist = $("#school_attachments #flist").val();
					var arr_flist = Array();
					var current_fpath = '';
					if (flist != '')
					{
							arr_flist = flist.split(",");
							current_fpath = arr_flist[0];
					}
					
					if (current_fpath != '')
					{					
							$.ajax({
					        url: url + 'school/upload_contract_file',
					        dataType:'json',
					        type:'POST',
					        async: false,
					        data: formData,
					        processData : false, //使数据不做处理
					        contentType : false,
					        success: function(data){			        		
					            if (data.code == '0') {
					            		flist = flist.replace(current_fpath,data.data);
					            		$("#school_attachments #flist").val(flist);
					            		$("#school_attachments #show_pic #attach1").append('&nbsp;&nbsp;<a href="/statics'+data.data+'" target="_blank">新上传的合同1</a>');
					            }else
					            {
					            		$('#school_attachments #alert_error').css('marginTop','10px');
					          			$('#school_attachments #alert_error').css('marginLeft','10%');
							   					$('#school_attachments #alert_error').addClass('alert-danger').show().delay(3000).fadeOut();
					          			$("#school_attachments #error_info").html('上传失败！');
					            }	
					        },
					        error:function(response){
					            console.log(response);
					        }
					    });
			  	}
			});
			
			$('#school_attachments #f1e2').live('change', function (e) {
					var formData = new FormData();					
					formData.append("file",$("#f1e2")[0].files[0]);
					var flist = $("#school_attachments #flist").val();
					var arr_flist = Array();
					var current_fpath = '';
					if (flist != '')
					{
							arr_flist = flist.split(",");
							current_fpath = arr_flist[1];
					}
					
					if (current_fpath != '')
					{					
							$.ajax({
					        url: url + 'school/upload_contract_file',
					        dataType:'json',
					        type:'POST',
					        async: false,
					        data: formData,
					        processData : false, //使数据不做处理
					        contentType : false,
					        success: function(data){			        		
					            if (data.code == '0') {
					            		flist = flist.replace(current_fpath,data.data);
					            		$("#school_attachments #flist").val(flist);
					            		$("#school_attachments #show_pic #attach2").append('&nbsp;&nbsp;<a href="/statics'+data.data+'" target="_blank">新上传的合同2</a>');
					            }else
					            {
					            		$('#school_attachments #alert_error').css('marginTop','10px');
					          			$('#school_attachments #alert_error').css('marginLeft','10%');
							   					$('#school_attachments #alert_error').addClass('alert-danger').show().delay(3000).fadeOut();
					          			$("#school_attachments #error_info").html('上传失败！');
					            }	
					        },
					        error:function(response){
					            console.log(response);
					        }
					    });
			  	}
			});
			
			$('#school_attachments #f1e3').live('change', function (e) {
					var formData = new FormData();					
					formData.append("file",$("#f1e3")[0].files[0]);
					var flist = $("#school_attachments #flist").val();
					var arr_flist = Array();
					var current_fpath = '';
					if (flist != '')
					{
							arr_flist = flist.split(",");
							current_fpath = arr_flist[2];
					}
					
					if (current_fpath != '')
					{					
							$.ajax({
					        url: url + 'school/upload_contract_file',
					        dataType:'json',
					        type:'POST',
					        async: false,
					        data: formData,
					        processData : false, //使数据不做处理
					        contentType : false,
					        success: function(data){			        		
					            if (data.code == '0') {
					            		flist = flist.replace(current_fpath,data.data);
					            		$("#school_attachments #flist").val(flist);
					            		$("#school_attachments #show_pic #attach3").append('&nbsp;&nbsp;<a href="/statics'+data.data+'" target="_blank">新上传的合同3</a>');
					            }else
					            {
					            		$('#school_attachments #alert_error').css('marginTop','10px');
					          			$('#school_attachments #alert_error').css('marginLeft','10%');
							   					$('#school_attachments #alert_error').addClass('alert-danger').show().delay(3000).fadeOut();
					          			$("#school_attachments #error_info").html('上传失败！');
					            }	
					        },
					        error:function(response){
					            console.log(response);
					        }
					    });
			  	}
			});
			
			function show_loading()
			{
					$('#loading_id').on('show.bs.modal', function(){
	          var $this = $(this);
	          var $modal_dialog = $this.find('.modal-dialog');
	          $this.css('display', 'block');
	          $modal_dialog.css({'margin-top': Math.max(0, ($(window).height() - $modal_dialog.height()) / 2) });
	        });
					$('#loading_id').modal('show');
			}
			
			v.$watch('subject', function(obj) {
					$('.default-date-picker1').datepicker({   				
				        format: 'dd/mm/yyyy'
				  });				 			    
			});						
      
      function show_knowledge_detail(id,parentId)
      {
      		sessionStorage.setItem("id", id);
      		sessionStorage.setItem("menu_parentid", parentId);
					window.location.href = "knowledge.html"; 
      } 
			
			function  formatDate(now)
			{
			    var   now= new Date(now);     
			    var   year=now.getFullYear();     
			    var   month=now.getMonth()+1;     
			    var   date=now.getDate();     
			    var   hour=now.getHours();
			    var   minute=now.getMinutes();     
			    var   second=now.getSeconds();
			    return fixZero(date,2)+"/"+fixZero(month,2)+"/"+year; 
			}  
			
			function fixZero(num,length)
			{     
			    var str=""+num;
			    var len=str.length;     var s="";
			    for(var i=length;i-->len;)
			    {         
			        s+="0";
			    }
			    return s+str;
			}
			
	    jQuery(document).ready(function() {
	    });
		</script>
	</body>

</html>